[pytest]
# Django settings module for testing
DJANGO_SETTINGS_MODULE = app.settings
addopts = 
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --cov=app
    --cov-report=term-missing
    --cov-report=html:htmlcov
    --cov-report=xml:coverage.xml
    --cov-fail-under=80
    --maxfail=10
    --durations=10
    --color=yes
    --disable-warnings

# Test discovery patterns
testpaths = 
    app/tests

python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Test markers
markers =
    unit: Unit tests for individual components
    integration: Integration tests for workflows
    api: API endpoint tests
    slow: Tests that take more than 5 seconds
    performance: Performance and benchmark tests
    pdf: Tests involving PDF processing
    redis: Tests requiring Redis connection
    celery: Tests involving Celery tasks
    files: Tests involving file operations
    security: Security-related tests

# Test timeout (in seconds)
timeout = 300
timeout_method = thread

# Parallel execution
numprocesses = auto

# Test output configuration
console_output_style = progress
live_logs = true
log_level = INFO
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Coverage configuration
cov_branch = true
cov_omit = 
    */migrations/*
    */venv/*
    */env/*
    */node_modules/*
    manage.py
    app/settings.py
    app/wsgi.py
    app/asgi.py
    */tests/*
    */__pycache__/*

# Django test configuration
django_find_project = false
django_debug_mode = false

# Mock configuration
mock_use_standalone_module = true

# Performance testing configuration
benchmark_sort = mean
benchmark_min_rounds = 5
benchmark_max_time = 2.0
benchmark_warmup = true
benchmark_warmup_iterations = 2

# Error handling
continue_on_collection_errors = false

# Asyncio configuration
asyncio_mode = auto

# Plugin configuration
# Note: These plugins should be installed via requirements-dev.txt

# Environment variables for testing
env = 
    TESTING = true
    DEBUG = false
    REDIS_URL = redis://localhost:6379/1
    CELERY_ALWAYS_EAGER = true
    CELERY_EAGER_PROPAGATES_EXCEPTIONS = true